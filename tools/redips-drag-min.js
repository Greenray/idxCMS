"use strict";var REDIPS=REDIPS||{};REDIPS.drag=(function(){var ap,b,ae,af,aR,az,aq,aY,X,B,at,M,ag,aX,x,a1,U,a5,a,v,C,aI,aK,E,aV,ar,W,c,aj,p,aS,aM,aH,aD,A,aW,r,aT,am,a4,e,av,j,S,N,aN,ah,aZ=null,aU=0,Y=0,Q=null,w=null,y={page:{x:0,y:0},div:{x:0,y:0},flag:{x:0,y:0}},aF,aE,ad=[],i=[],k,aA,aa,aQ=[],J=[],l=null,h=null,F={x:0,y:0},H={x:0,y:0,value:7,flag:false},aL=false,u=false,ac=null,z=null,ai=null,aG=null,Z=null,G=null,I=null,V=null,ao=null,d=false,ax=false,al="cell",ak={color_td:"#E7AB83",color_tr:"#E7AB83"},O=25,o=20,D={div:[],cname:"only",other:"deny"},aB={action:"deny",cname:"mark",exception:[]},aP="none",a3="dotted",aC,T="trash",aJ=true,q=true,au="p",R="multiple",aw="horizontal1",ab="bottom",K=true,L=false,P=null,an=null,ay=null,f=null,t=20,n=2,m=false,a0=true,a2=0,s=false,aO=false,g="White";ap=function(a6){var a7=this,a9,ba,a8;if(a6===undefined){a6="drag"}l=document.getElementById(a6);if(!document.getElementById("redips_clone")){a8=document.createElement("div");a8.id="redips_clone";a8.style.width=a8.style.height="1px";l.appendChild(a8)}ae("init");b();aX();REDIPS.event.add(window,"resize",aX);ba=l.getElementsByTagName("img");for(a9=0;a9<ba.length;a9++){REDIPS.event.add(ba[a9],"mousemove",aR);REDIPS.event.add(ba[a9],"touchmove",aR)}REDIPS.event.add(window,"scroll",v)};aR=function(){return false};b=function(){var be,bd,bc,ba,a7,a8,a6,bf,a9,bb;a6=l.getElementsByTagName("table");for(be=0,bd=0;be<a6.length;be++){if(a6[be].parentNode.id==="redips_clone"||a6[be].className.indexOf("nolayout")>-1){continue}ba=a6[be].parentNode;a7=0;do{if(ba.nodeName==="TD"){a7++}ba=ba.parentNode}while(ba&&ba!==l);i[bd]=a6[be];if(!i[bd].redips){i[bd].redips={}}i[bd].redips.container=l;i[bd].redips.nestedLevel=a7;i[bd].redips.idx=bd;a9=i[bd].getElementsByTagName("td");for(bc=0,bb=false;bc<a9.length;bc++){if(a9[bc].rowSpan>1){bb=true;break}}i[bd].redips.rowspan=bb;bd++}for(be=0,a8=k=1;be<i.length;be++){if(i[be].redips.nestedLevel===0){i[be].redips.nestedGroup=a8;i[be].redips.sort=k*100;bf=i[be].getElementsByTagName("table");for(bd=0;bd<bf.length;bd++){if(bf[bd].className.indexOf("nolayout")>-1){continue}bf[bd].redips.nestedGroup=a8;bf[bd].redips.sort=k*100+bf[bd].redips.nestedLevel}a8++;k++}}};az=function(ba){var a7=ba||window.event,bc,a8,a6,bd,bb;if(this.redips.animated===true){return true}a7.cancelBubble=true;if(a7.stopPropagation){a7.stopPropagation()}aL=a7.shiftKey;if(a7.which){a8=a7.which}else{a8=a7.button}if(W(a7)||(!a7.touches&&a8!==1)){return true}if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.selection&&document.selection.type==="Text"){try{document.selection.empty()}catch(a9){}}}if(a7.touches){bd=F.x=a7.touches[0].clientX;bb=F.y=a7.touches[0].clientY}else{bd=F.x=a7.clientX;bb=F.y=a7.clientY}H.x=bd;H.y=bb;H.flag=false;REDIPS.drag.obj_old=ax=d||this;REDIPS.drag.obj=d=this;u=d.className.indexOf("clone")>-1?true:false;aY(d);if(l!==d.redips.container){l=d.redips.container;b()}if(d.className.indexOf("row")===-1){REDIPS.drag.mode=al="cell"}else{REDIPS.drag.mode=al="row";REDIPS.drag.obj=d=j(d)}v();if(!u&&al==="cell"){d.style.zIndex=999}ac=aG=I=null;x();ai=z=ac;G=Z=aG;ao=V=I;REDIPS.drag.source_cell=P=aj("TD",d);REDIPS.drag.current_cell=an=P;REDIPS.drag.previous_cell=ay=P;if(al==="cell"){REDIPS.drag.myhandler_clicked(an)}else{REDIPS.drag.myhandler_row_clicked(an)}if(ac===null||aG===null||I===null){x();ai=z=ac;G=Z=aG;ao=V=I;if(ac===null||aG===null||I===null){return true}}aA=aa=false;REDIPS.event.add(document,"mousemove",B);REDIPS.event.add(document,"touchmove",B);REDIPS.event.add(document,"mouseup",X);REDIPS.event.add(document,"touchend",X);if(d.setCapture){d.setCapture()}if(ac!==null&&aG!==null&&I!==null){aE=a5(ac,aG,I)}a6=c(i[ai],"position");if(a6!=="fixed"){a6=c(i[ai].parentNode,"position")}bc=a(d,a6);aZ=[bb-bc[0],bc[1]-bd,bc[2]-bb,bd-bc[3]];l.onselectstart=function(be){a7=be||window.event;if(!W(a7)){if(a7.shiftKey){document.selection.clear()}return false}};return false};aq=function(a6){REDIPS.drag.myhandler_dblclicked()};aY=function(ba){var a9,a7,a6,a8;a9=aj("TABLE",ba.parentNode);a8=a9.redips.nestedGroup;for(a7=0;a7<i.length;a7++){if(i[a7].redips.nestedGroup===a8){i[a7].redips.sort=k*100+i[a7].redips.nestedLevel}}i.sort(function(bc,bb){return bb.redips.sort-bc.redips.sort});k++};j=function(a8){var bf,ba,a7,a9,bd=true,be,a6,bc,bb;if(a8.nodeName==="DIV"){a6=a8;a8=aj("TR",a8);if(a8.redips===undefined){a8.redips={}}a8.redips.div=a6;return a8}else{a7=a8;if(a7.redips===undefined){a7.redips={}}a8=aj("TABLE",a8);if(u&&aa){a6=a7.redips.div;a6.className=aN(a6.className.replace("clone",""))}bf=a8.cloneNode(true);if(u&&aa){a6.className=a6.className+" clone"}a9=bf.rows.length-1;for(bc=a9;bc>=0;bc--){if(bc!==a7.rowIndex){if(bd===true){be=bf.rows[bc];for(bb=0;bb<be.cells.length;bb++){if(be.cells[bb].className.indexOf("rowhandler")>-1){bd=false;break}}}bf.deleteRow(bc)}}if(!aa){a7.redips.empty_row=bd}bf.redips={};bf.redips.container=a8.redips.container;bf.redips.source_row=a7;N(a7,bf.rows[0]);aV(a7,bf.rows[0]);document.getElementById("redips_clone").appendChild(bf);ba=a(a7,"fixed");bf.style.position="fixed";bf.style.top=ba[0]+"px";bf.style.left=ba[3]+"px";bf.style.width=(ba[1]-ba[3])+"px";return bf}};S=function(bh,a9,bg){var bb=i[bh],bd=bb.rows[0].parentNode,ba=false,be,bc,a6,bf,a7,a8;a7=function(){if(!ba&&ax.redips.empty_row){e(ax,"empty",REDIPS.drag.row_empty_color)}else{a6=aj("TABLE",a6);a6.deleteRow(bf)}};if(bg===undefined){bg=d}else{ba=true}a6=bg.redips.source_row;bf=a6.rowIndex;be=bg.getElementsByTagName("tr")[0];bg.parentNode.removeChild(bg);a8=REDIPS.drag.myhandler_row_dropped_before(bf);if(a8!==false){if(!ba&&f.className.indexOf(REDIPS.drag.trash_cname)>-1){if(aa){REDIPS.drag.myhandler_row_deleted()}else{if(REDIPS.drag.trash_ask_row){if(confirm("Are you sure you want to delete row?")){a7();REDIPS.drag.myhandler_row_deleted()}else{delete ax.redips.empty_row;REDIPS.drag.myhandler_row_undeleted()}}else{a7();REDIPS.drag.myhandler_row_deleted()}}}else{if(ba||!aa){a7()}if(a9<bb.rows.length){bd.insertBefore(be,bb.rows[a9]);bc=bb.rows[a9+1].redips;if(bc&&bc.empty_row){bd.deleteRow(a9+1)}}else{bd.appendChild(be)}delete be.redips.empty_row;if(!ba){REDIPS.drag.myhandler_row_dropped(f)}}if(be.getElementsByTagName("table").length>0){b()}}else{}};N=function(bd,bb){var a8,a7,a6,ba,bc=[],a9=[];bc[0]=bd.getElementsByTagName("input");bc[1]=bd.getElementsByTagName("textarea");bc[2]=bd.getElementsByTagName("select");a9[0]=bb.getElementsByTagName("input");a9[1]=bb.getElementsByTagName("textarea");a9[2]=bb.getElementsByTagName("select");for(a8=0;a8<bc.length;a8++){for(a7=0;a7<bc[a8].length;a7++){ba=bc[a8][a7].type;switch(ba){case"text":case"textarea":case"password":a9[a8][a7].value=bc[a8][a7].value;break;case"radio":case"checkbox":a9[a8][a7].checked=bc[a8][a7].checked;break;case"select-one":a9[a8][a7].selectedIndex=bc[a8][a7].selectedIndex;break;case"select-multiple":for(a6=0;a6<bc[a8][a7].options.length;a6++){a9[a8][a7].options[a6].selected=bc[a8][a7].options[a6].selected}break}}}};X=function(bd){var bf=bd||window.event,a9,bg,ba,be,a8,a7,bb,bc,a6;a8=bf.clientX;a7=bf.clientY;y.flag.x=y.flag.y=0;if(d.releaseCapture){d.releaseCapture()}REDIPS.event.remove(document,"mousemove",B);REDIPS.event.remove(document,"touchmove",B);REDIPS.event.remove(document,"mouseup",X);REDIPS.event.remove(document,"touchend",X);l.onselectstart=null;d.style.left=0;d.style.top=0;d.style.zIndex=-1;d.style.position="static";Q=document.documentElement.scrollWidth;w=document.documentElement.scrollHeight;y.flag.x=y.flag.y=0;if(aa&&al==="cell"&&(ac===null||aG===null||I===null)){d.parentNode.removeChild(d);aQ[ax.id]-=1;REDIPS.drag.myhandler_notcloned()}else{if(ac===null||aG===null||I===null){REDIPS.drag.myhandler_notmoved()}else{if(ac<i.length){a9=i[ac];REDIPS.drag.target_cell=f=a9.rows[aG].cells[I];U(ac,aG,I,aE);bg=ac;ba=aG}else{if(z===null||Z===null||V===null){a9=i[ai];REDIPS.drag.target_cell=f=a9.rows[G].cells[ao];U(ai,G,ao,aE);bg=ai;ba=G}else{a9=i[z];REDIPS.drag.target_cell=f=a9.rows[Z].cells[V];U(z,Z,V,aE);bg=z;ba=Z}}if(al==="row"){if(!aA){REDIPS.drag.myhandler_row_notmoved()}else{if(ai===bg&&G===ba){be=d.getElementsByTagName("tr")[0];ax.style.backgroundColor=be.style.backgroundColor;for(bb=0;bb<be.cells.length;bb++){ax.cells[bb].style.backgroundColor=be.cells[bb].style.backgroundColor}d.parentNode.removeChild(d);delete ax.redips.empty_row;if(aa){REDIPS.drag.myhandler_row_notcloned()}else{REDIPS.drag.myhandler_row_dropped_source(f)}}else{S(bg,ba)}}}else{if(!aa&&!H.flag){REDIPS.drag.myhandler_notmoved()}else{if(aa&&ai===ac&&G===aG&&ao===I){d.parentNode.removeChild(d);aQ[ax.id]-=1;REDIPS.drag.myhandler_notcloned()}else{if(aa&&REDIPS.drag.delete_cloned===true&&(a8<a9.redips.offset[3]||a8>a9.redips.offset[1]||a7<a9.redips.offset[0]||a7>a9.redips.offset[2])){d.parentNode.removeChild(d);aQ[ax.id]-=1;REDIPS.drag.myhandler_notcloned()}else{if(f.className.indexOf(REDIPS.drag.trash_cname)>-1){d.parentNode.removeChild(d);if(REDIPS.drag.trash_ask){setTimeout(function(){if(confirm("Are you sure you want to delete?")){M()}else{if(!aa){i[ai].rows[G].cells[ao].appendChild(d);v()}REDIPS.drag.myhandler_undeleted()}},20)}else{M()}}else{if(REDIPS.drag.drop_option==="switch"){d.parentNode.removeChild(d);bc=f.getElementsByTagName("div");a6=bc.length;for(bb=0;bb<a6;bb++){if(bc[0]!==undefined){REDIPS.drag.obj_old=bc[0];P.appendChild(bc[0])}}at();if(a6){REDIPS.drag.myhandler_switched()}}else{if(REDIPS.drag.drop_option==="overwrite"){aD(f);at()}else{at()}}}}}}}if(al==="cell"&&d.getElementsByTagName("table").length>0){b()}v()}}z=Z=V=null};at=function(){var a6=REDIPS.drag.myhandler_dropped_before(f);if(a6!==false){if(REDIPS.drag.drop_option==="shift"&&ah(f)){A(P,f)}if(REDIPS.drag.multiple_drop==="top"&&f.hasChildNodes()){f.insertBefore(d,f.firstChild)}else{f.appendChild(d)}d.onmousedown=az;d.ontouchstart=az;d.ondblclick=aq;REDIPS.drag.myhandler_dropped(f);if(aa){REDIPS.drag.myhandler_cloned_dropped(f);ar()}}else{if(aa){d.parentNode.removeChild(d)}}};M=function(){var a6;REDIPS.drag.myhandler_deleted();if(aa){ar()}if(REDIPS.drag.drop_option==="shift"&&REDIPS.drag.shift_after){switch(REDIPS.drag.shift_option){case"vertical2":a6="lastInColumn";break;case"horizontal2":a6="lastInRow";break;default:a6="last"}A(P,p(a6,P)[2])}};B=function(bd){var bf=bd||window.event,a9=REDIPS.drag.bound,a8,a7,a6,ba,bb,bc,be;if(bf.touches){a7=F.x=bf.touches[0].clientX;a6=F.y=bf.touches[0].clientY}else{a7=F.x=bf.clientX;a6=F.y=bf.clientY}ba=Math.abs(H.x-a7);bb=Math.abs(H.y-a6);if(!aA){if(al==="cell"&&(u||(REDIPS.drag.clone_shiftKey===true&&aL))){REDIPS.drag.obj_old=ax=d;REDIPS.drag.obj=d=E(d,true);aa=true;REDIPS.drag.myhandler_cloned();a1()}else{if(al==="row"){if(u||(REDIPS.drag.clone_shiftKey_row===true&&aL)){aa=true}REDIPS.drag.obj_old=ax=d;REDIPS.drag.obj=d=j(d);d.style.zIndex=999}if(d.setCapture){d.setCapture()}d.style.position="fixed";v();x();if(al==="row"){if(aa){REDIPS.drag.myhandler_row_cloned()}else{REDIPS.drag.myhandler_row_moved()}}a1()}if(a7>aU-aZ[1]){d.style.left=(aU-(aZ[1]+aZ[3]))+"px"}if(a6>Y-aZ[2]){d.style.top=(Y-(aZ[0]+aZ[2]))+"px"}}aA=true;if(al==="cell"&&(ba>H.value||bb>H.value)&&!H.flag){H.flag=true;a1();REDIPS.drag.myhandler_moved()}if(a7>aZ[3]&&a7<aU-aZ[1]){d.style.left=(a7-aZ[3])+"px"}if(a6>aZ[0]&&a6<Y-aZ[2]){d.style.top=(a6-aZ[0])+"px"}if(a7<h[1]&&a7>h[3]&&a6<h[2]&&a6>h[0]&&y.flag.x===0&&y.flag.y===0&&(J.containTable||(a7<J[3]||a7>J[1]||a6<J[0]||a6>J[2]))){x();ag()}y.page.x=a9-(aU/2>a7?a7-aZ[3]:aU-a7-aZ[1]);if(y.page.x>0){if(y.page.x>a9){y.page.x=a9}be=C()[0];y.page.x*=a7<aU/2?-1:1;if(!((y.page.x<0&&be<=0)||(y.page.x>0&&be>=(Q-aU)))){if(y.flag.x++===0){REDIPS.event.remove(window,"scroll",v);aI(window)}}}else{y.page.x=0}y.page.y=a9-(Y/2>a6?a6-aZ[0]:Y-a6-aZ[2]);if(y.page.y>0){if(y.page.y>a9){y.page.y=a9}be=C()[1];y.page.y*=a6<Y/2?-1:1;if(!((y.page.y<0&&be<=0)||(y.page.y>0&&be>=(w-Y)))){if(y.flag.y++===0){REDIPS.event.remove(window,"scroll",v);aK(window)}}}else{y.page.y=0}for(bc=0;bc<ad.length;bc++){a8=ad[bc];if(a8.autoscroll&&a7<a8.offset[1]&&a7>a8.offset[3]&&a6<a8.offset[2]&&a6>a8.offset[0]){y.div.x=a9-(a8.midstX>a7?a7-aZ[3]-a8.offset[3]:a8.offset[1]-a7-aZ[1]);if(y.div.x>0){if(y.div.x>a9){y.div.x=a9}y.div.x*=a7<a8.midstX?-1:1;if(y.flag.x++===0){REDIPS.event.remove(a8.div,"scroll",v);aI(a8.div)}}else{y.div.x=0}y.div.y=a9-(a8.midstY>a6?a6-aZ[0]-a8.offset[0]:a8.offset[2]-a6-aZ[2]);if(y.div.y>0){if(y.div.y>a9){y.div.y=a9}y.div.y*=a6<a8.midstY?-1:1;if(y.flag.y++===0){REDIPS.event.remove(a8.div,"scroll",v);aK(a8.div)}}else{y.div.y=0}break}else{y.div.x=y.div.y=0}}bf.cancelBubble=true;if(bf.stopPropagation){bf.stopPropagation()}};ag=function(){if(ac<i.length&&(ac!==z||aG!==Z||I!==V)){if(z!==null&&Z!==null&&V!==null){U(z,Z,V,aE);REDIPS.drag.previous_cell=ay=i[z].rows[Z].cells[V];REDIPS.drag.current_cell=an=i[ac].rows[aG].cells[I];if(REDIPS.drag.drop_option==="switching"&&al==="cell"){aH(an,ay);v();x()}if(al==="cell"){REDIPS.drag.myhandler_changed(an)}else{if(al==="row"&&(ac!==z||aG!==Z)){REDIPS.drag.myhandler_row_changed(an)}}}a1()}};aX=function(){if(typeof(window.innerWidth)==="number"){aU=window.innerWidth;Y=window.innerHeight}else{if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){aU=document.documentElement.clientWidth;Y=document.documentElement.clientHeight}else{if(document.body&&(document.body.clientWidth||document.body.clientHeight)){aU=document.body.clientWidth;Y=document.body.clientHeight}}}Q=document.documentElement.scrollWidth;w=document.documentElement.scrollHeight;v()};x=function(){var a9,bh,ba,a6,bi,be,bd,bg,bb,bf=[],a8,a7,bc;a9=function(){if(z!==null&&Z!==null&&V!==null){ac=z;aG=Z;I=V}};a8=F.x;a7=F.y;for(ac=0;ac<i.length;ac++){if(i[ac].redips.enabled===false){continue}bf[0]=i[ac].redips.offset[0];bf[1]=i[ac].redips.offset[1];bf[2]=i[ac].redips.offset[2];bf[3]=i[ac].redips.offset[3];if(i[ac].sca!==undefined){bf[0]=bf[0]>i[ac].sca.offset[0]?bf[0]:i[ac].sca.offset[0];bf[1]=bf[1]<i[ac].sca.offset[1]?bf[1]:i[ac].sca.offset[1];bf[2]=bf[2]<i[ac].sca.offset[2]?bf[2]:i[ac].sca.offset[2];bf[3]=bf[3]>i[ac].sca.offset[3]?bf[3]:i[ac].sca.offset[3]}if(bf[3]<a8&&a8<bf[1]&&bf[0]<a7&&a7<bf[2]){ba=i[ac].redips.row_offset;for(aG=0;aG<ba.length-1;aG++){if(ba[aG]===undefined){continue}J[0]=ba[aG][0];if(ba[aG+1]!==undefined){J[2]=ba[aG+1][0]}else{for(bc=aG+2;bc<ba.length;bc++){if(ba[bc]!==undefined){J[2]=ba[bc][0];break}}}if(a7<=J[2]){break}}a6=aG;if(aG===ba.length-1){J[0]=ba[aG][0];J[2]=i[ac].redips.offset[2]}do{bi=i[ac].rows[aG].cells.length-1;for(I=bi;I>=0;I--){J[3]=ba[aG][3]+i[ac].rows[aG].cells[I].offsetLeft;J[1]=J[3]+i[ac].rows[aG].cells[I].offsetWidth;if(J[3]<=a8&&a8<=J[1]){break}}}while(i[ac].redips.rowspan&&I===-1&&aG-->0);if(aG<0||I<0){a9()}else{if(aG!==a6){J[0]=ba[aG][0];J[2]=J[0]+i[ac].rows[aG].cells[I].offsetHeight;if(a7<J[0]||a7>J[2]){a9()}}}bh=i[ac].rows[aG].cells[I];if(bh.childNodes.length>0&&bh.getElementsByTagName("table").length>0){J.containTable=true}else{J.containTable=false}if(bh.className.indexOf(REDIPS.drag.trash_cname)===-1){bg=bh.className.indexOf(REDIPS.drag.only.cname)>-1?true:false;if(bg===true){if(bh.className.indexOf(D.div[d.id])===-1){a9();break}}else{if(D.div[d.id]!==undefined&&D.other==="deny"){a9();break}else{bd=bh.className.indexOf(REDIPS.drag.mark.cname)>-1?true:false;if((bd===true&&REDIPS.drag.mark.action==="deny")||(bd===false&&REDIPS.drag.mark.action==="allow")){if(bh.className.indexOf(aB.exception[d.id])===-1){a9();break}}}}}bb=bh.className.indexOf("single")>-1?true:false;if(al==="cell"){if((REDIPS.drag.drop_option==="single"||bb)&&bh.childNodes.length>0){if(bh.childNodes.length===1&&bh.firstChild.nodeType===3){break}be=true;for(bc=bh.childNodes.length-1;bc>=0;bc--){if(bh.childNodes[bc].className&&bh.childNodes[bc].className.indexOf("drag")>-1){be=false;break}}if(!be&&z!==null&&Z!==null&&V!==null){if(ai!==ac||G!==aG||ao!==I){a9();break}}}if(bh.className.indexOf("rowhandler")>-1){a9();break}if(bh.parentNode.redips&&bh.parentNode.redips.empty_row){a9();break}}break}}};a1=function(){if(ac<i.length&&ac!==null&&aG!==null&&I!==null){aE=a5(ac,aG,I);U(ac,aG,I);z=ac;Z=aG;V=I}};U=function(bb,a6,a9,a8){var bc,a7,ba;if(al==="cell"&&H.flag){ba=i[bb].rows[a6].cells[a9].style;ba.backgroundColor=(a8===undefined)?REDIPS.drag.hover.color_td:a8.color[0].toString();if(REDIPS.drag.hover.border_td!==undefined){if(a8===undefined){ba.border=REDIPS.drag.hover.border_td}else{ba.borderTopWidth=a8.top[0][0];ba.borderTopStyle=a8.top[0][1];ba.borderTopColor=a8.top[0][2];ba.borderRightWidth=a8.right[0][0];ba.borderRightStyle=a8.right[0][1];ba.borderRightColor=a8.right[0][2];ba.borderBottomWidth=a8.bottom[0][0];ba.borderBottomStyle=a8.bottom[0][1];ba.borderBottomColor=a8.bottom[0][2];ba.borderLeftWidth=a8.left[0][0];ba.borderLeftStyle=a8.left[0][1];ba.borderLeftColor=a8.left[0][2]}}}else{if(al==="row"){bc=i[bb].rows[a6];for(a7=0;a7<bc.cells.length;a7++){ba=bc.cells[a7].style;ba.backgroundColor=(a8===undefined)?REDIPS.drag.hover.color_tr:a8.color[a7].toString();if(REDIPS.drag.hover.border_tr!==undefined){if(a8===undefined){if(ac===ai&&aG>G){ba.borderBottom=REDIPS.drag.hover.border_tr}else{if(ac!==ai||aG<G){ba.borderTop=REDIPS.drag.hover.border_tr}}}else{ba.borderTopWidth=a8.top[a7][0];ba.borderTopStyle=a8.top[a7][1];ba.borderTopColor=a8.top[a7][2];ba.borderBottomWidth=a8.bottom[a7][0];ba.borderBottomStyle=a8.bottom[a7][1];ba.borderBottomColor=a8.bottom[a7][2]}}}}}};a5=function(bb,a6,ba){var bc,a9,bd,a8={color:[],top:[],right:[],bottom:[],left:[]},a7=function(bi,bf){var bh="border"+bf+"Width",bg="border"+bf+"Style",be="border"+bf+"Color";return[c(bi,bh),c(bi,bg),c(bi,be)]};if(al==="cell"){bd=i[bb].rows[a6].cells[ba];a8.color[0]=bd.style.backgroundColor;if(REDIPS.drag.hover.border_td!==undefined){a8.top[0]=a7(bd,"Top");a8.right[0]=a7(bd,"Right");a8.bottom[0]=a7(bd,"Bottom");a8.left[0]=a7(bd,"Left")}}else{bc=i[bb].rows[a6];for(a9=0;a9<bc.cells.length;a9++){bd=bc.cells[a9];a8.color[a9]=bd.style.backgroundColor;if(REDIPS.drag.hover.border_tr!==undefined){a8.top[a9]=a7(bd,"Top");a8.bottom[a9]=a7(bd,"Bottom")}}}return a8};a=function(bc,a9,a8){var bb,a7=0,ba=0,a6=bc;if(a9!=="fixed"){bb=C();a7=0-bb[0];ba=0-bb[1]}if(a8===undefined||a8===true){do{a7+=bc.offsetLeft-bc.scrollLeft;ba+=bc.offsetTop-bc.scrollTop;bc=bc.offsetParent}while(bc&&bc.nodeName!=="BODY")}else{do{a7+=bc.offsetLeft;ba+=bc.offsetTop;bc=bc.offsetParent}while(bc&&bc.nodeName!=="BODY")}return[ba,a7+a6.offsetWidth,ba+a6.offsetHeight,a7]};v=function(){var a9,a8,ba,a7,a6;for(a9=0;a9<i.length;a9++){ba=[];a7=c(i[a9],"position");if(a7!=="fixed"){a7=c(i[a9].parentNode,"position")}for(a8=i[a9].rows.length-1;a8>=0;a8--){if(i[a9].rows[a8].style.display!=="none"){ba[a8]=a(i[a9].rows[a8],a7)}}i[a9].redips.offset=a(i[a9],a7);i[a9].redips.row_offset=ba}h=a(l);for(a9=0;a9<ad.length;a9++){a7=c(ad[a9].div,"position");a6=a(ad[a9].div,a7,false);ad[a9].offset=a6;ad[a9].midstX=(a6[1]+a6[3])/2;ad[a9].midstY=(a6[0]+a6[2])/2}};C=function(){var a7,a6;if(typeof(window.pageYOffset)==="number"){a7=window.pageXOffset;a6=window.pageYOffset}else{if(document.body&&(document.body.scrollLeft||document.body.scrollTop)){a7=document.body.scrollLeft;a6=document.body.scrollTop}else{if(document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)){a7=document.documentElement.scrollLeft;a6=document.documentElement.scrollTop}else{a7=a6=0}}}return[a7,a6]};aI=function(ba){var bd,a7,a8,a6,a9,bc=F.x,bb=F.y;if(y.flag.x>0){v();x();if(bc<h[1]&&bc>h[3]&&bb<h[2]&&bb>h[0]){ag()}}if(typeof(ba)==="object"){aF=ba}if(aF===window){a8=a7=C()[0];a6=Q-aU;a9=y.page.x}else{a8=aF.scrollLeft;a6=aF.scrollWidth-aF.clientWidth;a9=y.div.x}if(y.flag.x>0&&((a9<0&&a8>0)||(a9>0&&a8<a6))){if(aF===window){window.scrollBy(a9,0);a8=C()[0];bd=parseInt(d.style.left,10);if(isNaN(bd)){bd=0}}else{aF.scrollLeft+=a9}setTimeout(aI,REDIPS.drag.speed)}else{REDIPS.event.add(aF,"scroll",v);y.flag.x=0;J=[0,0,0,0]}};aK=function(ba){var bd,a7,a8,a6,a9,bc=F.x,bb=F.y;if(y.flag.y>0){v();x();if(bc<h[1]&&bc>h[3]&&bb<h[2]&&bb>h[0]){ag()}}if(typeof(ba)==="object"){aF=ba}if(aF===window){a8=a7=C()[1];a6=w-Y;a9=y.page.y}else{a8=aF.scrollTop;a6=aF.scrollHeight-aF.clientHeight;a9=y.div.y}if(y.flag.y>0&&((a9<0&&a8>0)||(a9>0&&a8<a6))){if(aF===window){window.scrollBy(0,a9);a8=C()[1];bd=parseInt(d.style.top,10);if(isNaN(bd)){bd=0}}else{aF.scrollTop+=a9}setTimeout(aK,REDIPS.drag.speed)}else{REDIPS.event.add(aF,"scroll",v);y.flag.y=0;J=[0,0,0,0]}};E=function(ba,a7){var a6=ba.cloneNode(true),a9,a8;if(a7===true){document.getElementById("redips_clone").appendChild(a6);a6.style.zIndex=999;a6.style.position="fixed";a9=a(ba);a8=a(a6);a6.style.top=(a9[0]-a8[0])+"px";a6.style.left=(a9[3]-a8[3])+"px"}if(a6.setCapture){a6.setCapture()}a6.className=a6.className.replace("clone","");if(aQ[ba.id]===undefined){aQ[ba.id]=0}a6.id=ba.id+"c"+aQ[ba.id];aQ[ba.id]+=1;aV(ba,a6);return(a6)};aV=function(a8,a7){var a9=[],a6;a9[0]=function(bb,ba){if(bb.redips){ba.redips={};ba.redips.enabled=bb.redips.enabled;ba.redips.container=bb.redips.container;if(bb.redips.enabled){ba.onmousedown=az;ba.ontouchstart=az;ba.ondblclick=aq}}};a9[1]=function(bb,ba){if(bb.redips){ba.redips={};ba.redips.empty_row=bb.redips.empty_row}};a6=function(be){var bd,bb,bc,ba=["DIV","TR"];bd=a8.getElementsByTagName(ba[be]);bb=a7.getElementsByTagName(ba[be]);for(bc=0;bc<bb.length;bc++){a9[be](bd[bc],bb[bc])}};if(a8.nodeName==="DIV"){a9[0](a8,a7)}else{if(a8.nodeName==="TR"){a9[1](a8,a7)}}a6(0);a6(1)};ar=function(){var a8,a9,a6,a7;a7=ax.className;a8=a7.match(/climit(\d)_(\d+)/);if(a8!==null){a9=parseInt(a8[1],10);a6=parseInt(a8[2],10);a6-=1;a7=a7.replace(/climit\d_\d+/g,"");if(a6<=0){a7=a7.replace("clone","");if(a9===2){a7=a7.replace("drag","");ax.onmousedown=null;ax.ontouchstart=null;ax.style.cursor="auto";REDIPS.drag.myhandler_clonedend2()}else{REDIPS.drag.myhandler_clonedend1()}}else{a7=a7+" climit"+a9+"_"+a6}ax.className=aN(a7)}};W=function(a7){var a6=false,a9,ba,a8=/\bnodrag\b/i;if(a7.srcElement){a9=a7.srcElement.nodeName;ba=a7.srcElement.className}else{a9=a7.target.nodeName;ba=a7.target.className}switch(a9){case"A":case"INPUT":case"SELECT":case"OPTION":case"TEXTAREA":a6=true;break;default:if(a8.test(ba)){a6=true}else{a6=false}}return a6};ae=function(bk,a8,bb){var bl,bj,bi,bh=[],bn=[],a9,be,bd,bg,bm,ba,bf,a7,a6,bp,bc=/\bdrag\b/i,bo=/\bnoautoscroll\b/i;be=REDIPS.drag.opacity_disabled;if(bk===true||bk==="init"){a7=az;a6=aq;a9=REDIPS.drag.border;bd="move";ba=true}else{a7=a6=null;a9=REDIPS.drag.border_disabled;bd="auto";ba=false}if(a8===undefined){bh=l.getElementsByTagName("div")}else{if(bb==="subtree"){if(typeof(a8)==="string"){bh=document.getElementById(a8).getElementsByTagName("div")}else{bh=a8.getElementsByTagName("div")}}else{if(typeof(a8)==="string"){bh[0]=document.getElementById(a8)}else{bh[0]=a8}}}for(bl=0,bj=0;bl<bh.length;bl++){if(bc.test(bh[bl].className)){if(bk==="init"||bh[bl].redips===undefined){bh[bl].redips={};bh[bl].redips.container=l}else{if(bk===true&&typeof(be)==="number"){bh[bl].style.opacity="";bh[bl].style.filter=""}else{if(bk===false&&typeof(be)==="number"){bh[bl].style.opacity=be/100;bh[bl].style.filter="alpha(opacity="+be+")"}}}bh[bl].onmousedown=a7;bh[bl].ontouchstart=a7;bh[bl].ondblclick=a6;bh[bl].style.borderStyle=a9;bh[bl].style.cursor=bd;bh[bl].redips.enabled=ba}else{if(bk==="init"){bg=c(bh[bl],"overflow");if(bg!=="visible"){REDIPS.event.add(bh[bl],"scroll",v);bp=c(bh[bl],"position");bf=a(bh[bl],bp,false);if(bo.test(bh[bl].className)){bm=false}else{bm=true}ad[bj]={div:bh[bl],offset:bf,midstX:(bf[1]+bf[3])/2,midstY:(bf[0]+bf[2])/2,autoscroll:bm};bn=bh[bl].getElementsByTagName("table");for(bi=0;bi<bn.length;bi++){bn[bi].sca=ad[bj]}bj++}}}}};r=function(a7){var a8,a6;if(typeof(a7)==="object"&&a7.nodeName==="DIV"){a7.parentNode.removeChild(a7)}else{if(typeof(a7)==="string"){a8=document.getElementById(a7);if(a8){a8.parentNode.removeChild(a8)}}}};af=function(a8,a7){var a6;if(typeof(a7)==="object"&&a7.nodeName==="TABLE"){a7.redips.enabled=a8}else{for(a6=0;a6<i.length;a6++){if(i[a6].className.indexOf(a7)>-1){i[a6].redips.enabled=a8}}}};c=function(a7,a6){var a8;if(a7&&a7.currentStyle){a8=a7.currentStyle[a6]}else{if(a7&&window.getComputedStyle){a8=document.defaultView.getComputedStyle(a7,null)[a6]}}return a8};aj=function(a7,a6){while(a6&&a6.nodeName!==a7){a6=a6.parentNode}return a6};p=function(ba,a8){var a9=aj("TABLE",a8),a6,a7,bb;switch(ba){case"firstInColumn":a6=0;a7=a8.cellIndex;break;case"firstInRow":a6=a8.parentNode.rowIndex;a7=0;break;case"lastInColumn":a6=a9.rows.length-1;a7=a8.cellIndex;break;case"lastInRow":a6=a8.parentNode.rowIndex;a7=a9.rows[0].cells.length-1;break;case"last":a6=a9.rows.length-1;a7=a9.rows[0].cells.length-1;break;default:a6=a7=0}bb=a9.rows[a6].cells[a7];return[a6,a7,bb]};aS=function(bc,bg){var bh="",bb,bd,a9,bj,a8,bi,a7,a6,bf,be,bk=[],ba=REDIPS.drag.save_pname;if(typeof(bc)==="string"){bc=document.getElementById(bc)}if(bc!==undefined&&typeof(bc)==="object"&&bc.nodeName==="TABLE"){a9=bc.rows.length;for(a6=0;a6<a9;a6++){bj=bc.rows[a6].cells.length;for(bf=0;bf<bj;bf++){a8=bc.rows[a6].cells[bf];if(a8.childNodes.length>0){for(be=0;be<a8.childNodes.length;be++){bi=a8.childNodes[be];if(bi.nodeName==="DIV"&&bi.className.indexOf("drag")>-1){bh+=ba+"[]="+bi.id+"_"+a6+"_"+bf+"&";bk.push([bi.id,a6,bf])}}}}}if(bg==="json"&&bk.length>0){bh=JSON.stringify(bk)}else{bh=bh.substring(0,bh.length-1)}}return bh};aM=function(bb){var bf="",ba,bc,a9,bh,a8,bg,a7,a6,be,bd;if(typeof(bb)==="string"){bb=document.getElementById(bb)}if(bb!==undefined&&typeof(bb)==="object"&&bb.nodeName==="TABLE"){a9=bb.rows.length;for(a6=0;a6<a9;a6++){bh=bb.rows[a6].cells.length;for(be=0;be<bh;be++){a8=bb.rows[a6].cells[be];if(a8.childNodes.length>0){for(bd=0;bd<a8.childNodes.length;bd++){bg=a8.childNodes[bd];if(bg.nodeName==="DIV"&&((bg.className.indexOf("group")>-1)||(bg.className.indexOf("drag")>-1))){bf+=bg.id+"&"}}}}}bf=bf.substring(0,bf.length-1)}return bf};aH=function(bd,bc,ba){var a8,a7,a9,bb,a6;a6=function(be,bg){var bf=REDIPS.drag.get_position(bg);REDIPS.drag.move_object({obj:be,target:bf,callback:function(bi){var bh;a2--;if(a2===0){bh=REDIPS.drag.find_parent("TABLE",bi);REDIPS.drag.enable_table(true,bh)}}})};if(bd===bc){return}bb=bd.childNodes.length;if(ba==="animation"){if(bb>0){a9=aj("TABLE",bc);REDIPS.drag.enable_table(false,a9)}for(a8=0;a8<bb;a8++){if(bd.childNodes[a8].nodeType===1&&bd.childNodes[a8].nodeName==="DIV"&&REDIPS.drag.obj!==bd.childNodes[a8]){a2++;a6(bd.childNodes[a8],bc)}}}else{for(a8=0,a7=0;a8<bb;a8++){if(bd.childNodes[a7].nodeType===1&&bd.childNodes[a7].nodeName==="DIV"&&REDIPS.drag.obj!==bd.childNodes[a7]){bc.appendChild(bd.childNodes[a7])}else{a7++}}}};aD=function(a8){var a6,a7;if(a8.nodeName!=="TD"){return false}a7=a8.childNodes.length;for(a6=0;a6<a7;a6++){a8.removeChild(a8.childNodes[0])}};A=function(a7,a6){var a9,a8,bi,bk,bh,bc,bb,ba,bg,bl,bf,bj,be,bd;if(a7===a6){return}bg=REDIPS.drag.shift_option;bk=[a7.parentNode.rowIndex,a7.cellIndex];bh=[a6.parentNode.rowIndex,a6.cellIndex];a9=aj("TABLE",a7);a8=aj("TABLE",a6);bl=a8.rows.length-1;bf=a8.rows[0].cells.length-1;switch(bg){case"vertical2":bi=(a9===a8&&a7.cellIndex===a6.cellIndex)?bk:p("lastInColumn",a6);break;case"horizontal2":bi=(a9===a8&&a7.parentNode.rowIndex===a6.parentNode.rowIndex)?bk:p("lastInRow",a6);break;default:bi=(a9===a8)?bk:[bl,bf]}if(bg==="vertical1"||bg==="vertical2"){bc=(bi[1]*1000+bi[0]<bh[1]*1000+bh[0])?1:-1;bd=bl;bj=0;be=1}else{bc=(bi[0]*1000+bi[1]<bh[0]*1000+bh[1])?1:-1;bd=bf;bj=1;be=0}while(bi[0]!==bh[0]||bi[1]!==bh[1]){ba=a8.rows[bi[0]].cells[bi[1]];bi[bj]+=bc;if(bi[bj]<0){bi[bj]=bd;bi[be]--}else{if(bi[bj]>bd){bi[bj]=0;bi[be]++}}bb=a8.rows[bi[0]].cells[bi[1]];if(REDIPS.drag.animation_shift){aH(bb,ba,"animation")}else{aH(bb,ba)}}};aW=function(be){var a9={direction:1},a8,bj,bd,bg,a6,bi,bc,bf,bm,ba,bl,bk,bh,bb,a7;a9.callback=be.callback;if(typeof(be.id)==="string"){a9.obj=a9.obj_old=document.getElementById(be.id)}else{if(typeof(be.obj)==="object"&&be.obj.nodeName==="DIV"){a9.obj=a9.obj_old=be.obj}}if(be.mode==="row"){a9.mode="row";bb=am(be.source[0]);bm=be.source[1];ax=a9.obj_old=i[bb].rows[bm];a9.obj=j(a9.obj_old)}else{if(a9.obj.className.indexOf("row")>-1){a9.mode="row";a9.obj=a9.obj_old=ax=aj("TR",a9.obj);a9.obj=j(a9.obj_old)}else{a9.mode="cell"}}a9.obj.style.zIndex=999;if(l!==a9.obj.redips.container){l=a9.obj.redips.container;b()}bh=a(a9.obj);bd=bh[1]-bh[3];bg=bh[2]-bh[0];a8=bh[3];bj=bh[0];if(be.target===undefined){be.target=a4()}a9.target=be.target;bb=am(be.target[0]);bm=be.target[1];ba=be.target[2];a9.target_cell=i[bb].rows[bm].cells[ba];if(a9.mode==="cell"){bh=a(a9.target_cell);bc=bh[1]-bh[3];bf=bh[2]-bh[0];a6=bh[3]+(bc-bd)/2;bi=bh[0]+(bf-bg)/2}else{bh=a(i[bb].rows[bm]);bc=bh[1]-bh[3];bf=bh[2]-bh[0];a6=bh[3];bi=bh[0]}bl=a6-a8;bk=bi-bj;a9.obj.style.position="fixed";if(Math.abs(bl)>Math.abs(bk)){a9.type="horizontal";a9.m=bk/bl;a9.b=bj-a9.m*a8;a9.k1=(a8+a6)/(a8-a6);a9.k2=2/(a8-a6);if(a8>a6){a9.direction=-1}bb=a8;a9.last=a6}else{a9.type="vertical";a9.m=bl/bk;a9.b=a8-a9.m*bj;a9.k1=(bj+bi)/(bj-bi);a9.k2=2/(bj-bi);if(bj>bi){a9.direction=-1}bb=bj;a9.last=bi}a9.obj.redips.animated=true;aT(bb,a9);return[a9.obj,a9.obj_old]};aT=function(a7,a9){var a6=(a9.k1-a9.k2*a7)*(a9.k1-a9.k2*a7),a8;a7=a7+REDIPS.drag.animation_step*(4-a6*3)*a9.direction;a8=a9.m*a7+a9.b;if(a9.type==="horizontal"){a9.obj.style.left=a7+"px";a9.obj.style.top=a8+"px"}else{a9.obj.style.left=a8+"px";a9.obj.style.top=a7+"px"}if((a7<a9.last&&a9.direction>0)||((a7>a9.last)&&a9.direction<0)){setTimeout(function(){aT(a7,a9)},REDIPS.drag.animation_pause*a6)}else{a9.obj.style.zIndex=-1;a9.obj.style.position="static";a9.obj.redips.animated=false;if(a9.mode==="cell"){a9.target_cell.appendChild(a9.obj)}else{S(am(a9.target[0]),a9.target[1],a9.obj)}if(typeof(a9.callback)==="function"){a9.callback(a9.obj)}}};a4=function(bc){var a6,bb,be,bd,a7,a8,a9,ba=[];if(bc===undefined){if(ac<i.length){a6=i[ac].redips.idx}else{if(z===null||Z===null||V===null){a6=i[ai].redips.idx}else{a6=i[z].redips.idx}}bb=i[ai].redips.idx;ba=[a6,aG,I,bb,G,ao]}else{if(typeof(bc)==="string"){a8=document.getElementById(bc)}else{a8=bc}a8=aj("TD",a8);if(a8&&a8.nodeName==="TD"){be=a8.cellIndex;bd=a8.parentNode.rowIndex;a9=aj("TABLE",a8.parentNode);a7=a9.redips.idx;ba=[a7,bd,be]}}return ba};am=function(a6){var a7;for(a7=0;a7<i.length;a7++){if(i[a7].redips.idx===a6){break}}return a7};aN=function(a6){if(a6!==undefined){a6=a6.replace(/^\s+|\s+$/g,"").replace(/\s{2,}/g," ")}return a6};ah=function(a7){var a6;for(a6=0;a6<a7.childNodes.length;a6++){if(a7.childNodes[a6].nodeType===1){return true}}return false};e=function(ba,a9,a6){var bb,a8,a7;if(typeof(ba)==="string"){ba=document.getElementById(ba);ba=aj("TABLE",ba)}if(ba.nodeName==="TR"){bb=ba.getElementsByTagName("td");for(a8=0;a8<bb.length;a8++){bb[a8].style.backgroundColor=a6?a6:"";if(a9==="empty"){bb[a8].innerHTML=""}else{for(a7=0;a7<bb[a8].childNodes.length;a7++){if(bb[a8].childNodes[a7].nodeType===1){bb[a8].childNodes[a7].style.opacity=a9/100;bb[a8].childNodes[a7].style.filter="alpha(opacity="+a9+")"}}}}}else{ba.style.opacity=a9/100;ba.style.filter="alpha(opacity="+a9+")"}};av=function(a8,a7,a6){var a9=document.getElementById(a8),ba=a9.rows[a7];if(a6===undefined){a6=REDIPS.drag.row_empty_color}if(ba.redips===undefined){ba.redips={}}ba.redips.empty_row=true;e(ba,"empty",a6)};return{obj:d,obj_old:ax,mode:al,source_cell:P,previous_cell:ay,current_cell:an,target_cell:f,hover:ak,bound:O,speed:o,only:D,mark:aB,border:aP,border_disabled:a3,opacity_disabled:aC,trash_cname:T,trash_ask:aJ,trash_ask_row:q,save_pname:au,drop_option:R,shift_option:aw,multiple_drop:ab,delete_cloned:K,delete_shifted:L,clone_shiftKey:s,clone_shiftKey_row:aO,animation_pause:t,animation_step:n,animation_shift:m,shift_after:a0,row_empty_color:g,init:ap,enable_drag:ae,enable_table:af,clone_div:E,save_content:aS,scan_table:aM,relocate:aH,empty_cell:aD,move_object:aW,shift_cells:A,delete_object:r,get_position:a4,row_opacity:e,row_empty:av,getScrollPosition:C,get_style:c,find_parent:aj,myhandler_clicked:function(){},myhandler_dblclicked:function(){},myhandler_moved:function(){},myhandler_notmoved:function(){},myhandler_dropped:function(){},myhandler_dropped_before:function(){},myhandler_switched:function(){},myhandler_changed:function(){},myhandler_cloned:function(){},myhandler_cloned_dropped:function(){},myhandler_clonedend1:function(){},myhandler_clonedend2:function(){},myhandler_notcloned:function(){},myhandler_deleted:function(){},myhandler_undeleted:function(){},myhandler_row_clicked:function(){},myhandler_row_moved:function(){},myhandler_row_notmoved:function(){},myhandler_row_dropped:function(){},myhandler_row_dropped_before:function(){},myhandler_row_dropped_source:function(){},myhandler_row_changed:function(){},myhandler_row_cloned:function(){},myhandler_row_notcloned:function(){},myhandler_row_deleted:function(){},myhandler_row_undeleted:function(){}}}());if(!REDIPS.event){REDIPS.event=(function(){var b,a;b=function(e,c,d){if(e.addEventListener){e.addEventListener(c,d,false)}else{if(e.attachEvent){e.attachEvent("on"+c,d)}else{e["on"+c]=d}}};a=function(e,c,d){if(e.removeEventListener){e.removeEventListener(c,d,false)}else{if(e.detachEvent){e.detachEvent("on"+c,d)}else{e["on"+c]=null}}};return{add:b,remove:a}}())};